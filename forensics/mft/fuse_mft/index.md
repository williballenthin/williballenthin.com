---
layout: page
title: "fuse-mft: A FUSE driver for MFT files"
date: 2014-01-11 12:00
comments: false
sharing: false
footer: true
---

`fuse-mft` is a [FUSE](http://fuse.sourceforge.org) file system driver for MFT files. It allows an analyst
to mount the file system tree defined by an MFT on their analysis machine.
Then, they can use familiar command line or graphical tools to explore the
contents. `fuse-mft` uses the metadata found within the MFT to populate the 
entries, and exposes a few virtual files to provide additional context.  


Download
--------
`fuse-mft` is a component of the [INDXParse suite](/forensics/mft/indxparse)
of tools used for NTFS analysis. All INDXParse tools are free and open source.
The source for `fuse-mft` is hosted on Github 
[here](https://github.com/williballenthin/INDXParse/blob/master/fuse-mft.py).


Highlights
----------
**Analyze an MFT using familiar tools** `fuse-mft` exposes the file system
metadata stored within an MFT to the tools with which you're already an expert.
For example, you can explore the filenames and timestamps of a directory 
using a graphical file explorer, or generate a high level description using
`tree`. You might even begin generating your timelines with
[find](http://gist.github.com/williballenthin/7214987)!


**Extra context from virtual files** `fuse-mft` provides additional information
about files and directories using "virtual files" --- that is, files you can
access, but are not backed by the MFT. The contents of the virtual files are the
same reports generated by [get-file-info](/forensics/mft/get_file_info/):

  - parsed out attributes
  - timelines of file activity
  - resident file content
  - ...and more


**Free** All INDXParse tools are free and 
[open source](https://raw2.github.com/williballenthin/INDXParse/master/LICENSE). 
Forensic practitioners drive the development by contributing ideas, bug reports, 
and patches. Since the source is in the open and covered by a liberal licnse,
you'll never have to worry about the tools disappearing. 


Installation
------------
`fuse-mft` is part of the INDXParse suite of tools that are distributed
together. To acquire INDXParse, download the latest ZIP archive from 
[here](https://github.com/williballenthin/INDXParse/archive/master.zip) or use
`git` to clone the source repository:

{% highlight sh %}
git clone https://github.com/williballenthin/INDXParse.git
{% endhighlight %}

`fuse-mft` depends on a few freely available external packages. Firstly,
the FUSE framework must be installed. On a Debian based system, this mean
you must install the package `fuse`. 

The tool also depends on four Python packages. You should
install these using `pip`, as described 
[here](/blog/2014/01/11/how-to-install-the-python-package-manager/).
 The modules are:

  - [argparse](https://pypi.python.org/pypi/argparse)
  - [jinja2](http://jinja.pocoo.org/docs/)
  - [progressbar](http://code.google.com/p/python-progressbar/)
  - [fusepy](https://github.com/terencehonles/fusepy/)

You can install them all in one go like this:

{% highlight sh %}
pip install argparse jinja2 python-progressbar fusepy
{% endhighlight %}


Usage
-----

Mounting
========
`fuse-mft` is a Python script that interacts with the FUSE framework to
provide a file system driver for MFT files. Unfortunately, to the best
of my knowledge, FUSE is specific to UNIX-like operating systems. That
being said, the script accepts two required command line parameters.

  - The first parameter is the path to a previously acquired raw MFT file.
  - The second parameter is the target mount path. This should probably be
an empty directory. Once the file system is mounted, you can expect to 
find its contents in the mount path directory.


To confirm `fuse-mft` has exposed a file system, check 
the mount table for an entry named "MFTFuseOperations". The following
shows an MFT mounted at "/tmp/mounted_mft":

{% highlight sh %}
Git/INDXParse - [master●] » mount | grep MFTFuseOperations
MFTFuseOperations on /tmp/mounted_mft type fuse (rw,nosuid,nodev,user=willi)
{% endhighlight %}

Exploring
=========
Once an MFT is mounted, you can explore the MFT using any existing tools
that interact with a file system.  Here are some things I like to do:

  - use `find` to enumerate files and metadata
  - use `nautilus` to explore directories graphically
  - use `cat` to show the contents of files with resident data

For each file and directory, you can read from a parallel virtual file that
contains a report on its MFT entry. Construct the virtual file's path by 
appending "::meta" to the target file's path. You should be able to open 
the virtual files using `cat`, `gedit`, or another text editor. See the 
features of [get-file-info](/forensics/mft/get_file_info)
for a full description of the report contents.

Here's an example showing the analyst reviewing the contents of the "win.ini"
file, as well as its MFT record report:

{% highlight sh %}
mounted_mft/WINDOWS  » cat win.ini | head
; for 16-bit app support
[fonts]
[extensions]
[mci extensions]
[files]
[MCI Extensions.BAK]
aif=MPEGVideo
aifc=MPEGVideo
aiff=MPEGVideo
asf=MPEGVideo


mounted_mft/WINDOWS  » cat win.ini::meta | head
MFT Record: 226
Path: /WINDOWS/win.ini
Metadata:
  Active: 1
  Type: file
  Flags: archive
  $SI Modified: 2012-02-03 11:18:58.315498
  $SI Accessed: 2012-03-19 11:04:37.933453
  $SI Changed: 2012-02-03 11:18:58.315498
  $SI Birthed: 2004-08-04 12:00:00
{% endhighlight %}

Unmounting
==========
To unmount a `fuse-mft` file system, use your system's `umount` command
as you would another file system. The command I use typically looks something
like this:

{% highlight sh %}
sudo umount /path/to/mountpoint
{% endhighlight %}

I recommend against killing the `fuse-mft` process to avoid leaving the system
in an unstable state.
