{{ partial "header.html" . }}

<body lang="{{ .Site.LanguageCode }}">
  <nav class="container">
    <span class="breadcrumbs">
      <a href="{{ .Site.Home.RelPermalink }}" class="breadcrumb">{{ .Site.Title }}</a>
      {{ with .Site.GetPage "/ida" }}
      <a href="{{ .RelPermalink  }}" class="breadcrumb">ida</a>
      {{ end }}
      {{ if ne .RelPermalink "/ida/" }}
      <span class="breadcrumb">{{ .Title }}</span>
      {{ end }}
    </span>
  </nav>

  <main class="container">
    <div>
      <h1>{{ .Title }}</h1>
      
      {{ with .Content }}
      <div class="content">
        {{ . }}
      </div>
      {{ end }}

      {{ if eq .RelPermalink "/ida/plugins/activity/" }}
      <!-- Group pages by month for the plugin activity listing -->
      {{ $pages := .Site.GetPage "/ida/plugins/activity" }}
      {{ $byMonth := dict }}
      {{ range $pages.RegularPagesRecursive }}
        {{ $monthKey := .Date.Format "2006-01" }}
        {{ $monthName := .Date.Format "January 2006" }}
        {{ $existing := index $byMonth $monthKey }}
        {{ if $existing }}
          {{ $byMonth = merge $byMonth (dict $monthKey (dict "name" $monthName "pages" (append $existing.pages .))) }}
        {{ else }}
          {{ $byMonth = merge $byMonth (dict $monthKey (dict "name" $monthName "pages" (slice .))) }}
        {{ end }}
      {{ end }}

      {{ range $monthKey, $monthData := $byMonth }}
        {{ $sortedPages := sort $monthData.pages ".Date" "desc" }}
        <h2>{{ $monthData.name }}</h2>
        <ul class="content-list">
          {{ range $sortedPages }}
          <li>
            <a href="{{ .RelPermalink}}" class="entry-link">{{ .Date.Format "January 2, 2006" }}</a>
          </li>
          {{ end }}
        </ul>
      {{ end }}

      {{ else }}
      <!-- For other ida sections, show regular listing -->
      {{ if .Pages }}
      <ul class="content-list">
        {{ range .Pages.ByDate.Reverse }}
        <li>
          <a href="{{ .RelPermalink}}" class="entry-link">{{ .Title }}</a><br/>
          <span class="date">{{ .Date.Format "January 2, 2006" }}</span>
        </li>
        {{ end }}
      </ul>
      {{ end }}

      {{ if .Sections }}
      <h2>Browse by Section</h2>
      <ul class="content-list">
        {{ range .Sections.ByTitle }}
        <li>
          <a href="{{ .RelPermalink}}" class="entry-link">{{ .Title }}</a>
        </li>
        {{ end }}
      </ul>
      {{ end }}
      {{ end }}
    </div>
  </main>

  {{ partial "footer.html" . }}
  </body>

<!-- layout: ida/list.html -->
</html>